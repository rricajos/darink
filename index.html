<!doctype html>
<html lang="es">

<head>
  <title>Darink App</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="manifest" href="manifest.json">

  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">

</head>

<body>

  <header>
    <h1>Darink App </h1>
    <i id="appVersion"></i>
  </header>


  <nav id="mainTabs">

    <button data-go="add" class="active"><span style="font-size: 1.5rem;">
        <i class="fa fa-rocket" aria-hidden="true"></i>
      </span>
      <br><i>Lunch</i>
    </button>

    <button data-go="list"> <span style="font-size: 1.5rem;">
        <i class="fa fa-book" aria-hidden="true"></i>
      </span>
      <br><i>LogBook</i>
    </button>

    <button data-go="settings">
      <span style="font-size: 1.5rem;">
        <i class="fa fa-cog" aria-hidden="true"></i>
      </span>
      <br><i>Settings</i>
    </button>

  </nav>

  <!-- TAB: A√±adir -->
  <div data-tab="add">
    <nav id="progressNav">
      <button data-step="0">Paso&nbsp;1</button>
      <button data-step="1">Paso&nbsp;2</button>
      <button data-step="2">Paso&nbsp;3</button>
    </nav>
    <div id="progressContainer">
      <div id="progressBar"></div>
    </div>

    <form id="entryForm">
      <input type="hidden" id="editIndex">
      <section data-step="0">

        <label>Lugar
          <select name="location" required>
            <option value="casa">Casa</option>
            <option value="colegio">Colegio/Trabajo</option>
            <option value="otro">Otro</option>
          </select>
        </label>


        <div id="timeDash">
          <button type="button" id="btnStartNow">Voy a empezar</button>
          <button type="button" id="btnEndNow">He terminado</button>
        </div>
        <br>

        <div id="startFields">
          <label>
            <span>Fecha de <strong>inicio</strong></span>
            <input type="date" id="dateStart" name="dateStart" required>
          </label><br>
          <label>
            <span>Hora de <strong>inicio</strong></span>
            <input type="time" id="timeStart" name="timeStart" required>
          </label><br>
        </div>

        <div id="endFields" hidden>
          <label>
            <span>Fecha de <strong>fin</strong></span>
            <input type="date" id="dateEnd" name="dateEnd" required>
          </label><br>
          <label><span>Hora de <strong>fin</strong></span>
            <input type="time" id="timeEnd" name="timeEnd" required>
          </label><br>
        </div>


        <button type="button" id="swapDates" hidden>‚ÜîÔ∏é</button><br>

        <button type="button" id="next0" class="focusable">Siguiente</button>

      </section>


      <section data-step="1" hidden>
        <label>Qu√©:<br><textarea name="what" required autofocus></textarea></label><br>
        <label>Cantidad:
          <select name="amount">
            <option value="poco">Poco</option>
            <option value="normal">Normal</option>
            <option value="mucho">Mucho</option>
          </select>
        </label><br>
        <label>Proporci√≥n:
          <select name="portion">
            <option value="1/3">‚Öì</option>
            <option value="2/3">‚Öî</option>
            <option value="3/3">3‚ÅÑ3</option>
          </select>
        </label><br>
        <button type="button" id="back1">Atr√°s</button>
        <button type="button" id="next1" class="focusable">Siguiente</button>
      </section>

      <section data-step="2" hidden>
        <label>C√≥mo se sinti√≥:
          <select name="mood">
            <option value="verde">üü¢ Verde</option>
            <option value="ambar">üü† √Åmbar</option>
            <option value="rojo">üî¥ Rojo</option>
          </select>
        </label><br>
        <label>Comentario: <input type="text" name="comment"></label><br>
        <button type="button" id="back2">Atr√°s</button>
        <button type="submit" class="donnable">Guardar</button>
      </section>
      <button type="button" id="cancelEdit" hidden>Cancelar edici√≥n</button>
    </form>
  </div>

  <!-- TAB: Lista / Estad√≠stica -->
  <div data-tab="list">
    <div style="display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap;">
      <input type="search" id="searchTxt" placeholder="Buscar‚Ä¶" style="flex: 1;">
      <button id="toggleFilters" title="Mostrar/ocultar filtros">
        Filtros
        <i id="toggleFiltersIcon" class="fa fa-filter" aria-hidden="true"></i>
      </button>
    </div>

    <div id="filterPanel" hidden style="padding: 1rem;">
      <label>Desde <input type="date" id="fFrom"></label>
      <label>Hasta <input type="date" id="fTo"></label>
      <label>Estado
        <select id="fMood">
          <option value="">Todos</option>
          <option value="verde">üü¢</option>
          <option value="ambar">üü†</option>
          <option value="rojo">üî¥</option>
        </select>
      </label><br>
      <button id="applyFilter">Filtrar</button><br>
      <button id="clearFilter">Limpiar</button>
    </div>


    <button id="delSelBtn" disabled>Eliminar seleccionados</button>
    <ul id="entries"></ul>

    <div id="statsBox" hidden>
      <canvas id="statsCanvas" width="300" height="150"></canvas>
      <button id="closeStats">Cerrar</button>
    </div>
  </div>

  <!-- TAB: Ajustes -->
  <div data-tab="settings">
    <h3><i class="fa fa-database" aria-hidden="true"></i> Base de Datos</h3>
    <p>T√∫ alojas tu propia informaci√≥n en este dispositivo y eres el √∫nico responsable de su uso i difusi√≥n.</p>
    <!-- <button id="exportBtn">Exportar base de datos acutal</button> -->
    <div style="display: flex; gap: 1rem; align-items: flex-start; flex-direction: row;">

      <button id="exportBtn">
        <i class="fa fa-upload" aria-hidden="true"></i>

        Exportar Base de Datos

      </button>

      <button style="position: relative;">

        <i class="fa fa-download" aria-hidden="true"></i>
        Importar Base de datos
        <input type="file" id="importInput" accept=".json"
          style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; opacity: 0;">
      </button>

      <button id="clearBtn">
        <i class="fa fa-trash" aria-hidden="true"></i>

        Borrar tu informaci√≥n</button>
    </div>


  </div>

  <!-- TAB: Ajustes  -->
  <div data-tab="settings">
    <h3><i class="fa fa-plane" aria-hidden="true"></i> Modo Offline</h3>
    <p>As√≠ podr√°s usar nuestras funciones sin conexi√≥n y trabajar con tu informaci√≥n aunque no tengas internet.</p>

    <button id="installBtn" hidden>
      <i class="fa fa-play" aria-hidden="true"></i>
      Instalar app
    </button>

    <button id="uninstallBtn" hidden>
      <i class="fa fa-trash" aria-hidden="true"></i>
      Desinstalar app
    </button>

  </div>

  <!-- TAB: Ajustes // modo noche activado/desactivado manualmente con detecci√≥n del tema del dispositivo -->
  <div data-tab="settings">
    <h3>
      <i class="fa fa-moon-o" aria-hidden="true"></i>
      Tema
    </h3>
    <label style="flex-direction: row; padding: 0.5rem 1rem  0 0;">
      <input style="scale: 1.25;" type="checkbox" id="themeToggle"> Usar tema oscuro
    </label>

  </div>
  <!-- 
  <script type="module" src="ui.js"></script>
  <script type="module" src="datepicker.js"></script> -->
  <script type="module" src="./js/utils.js"></script>
  <script type="module" src="./js/version.js"></script>
  <script type="module" src="./js/sync-version.js"></script>
  <script type="module" src="./js/controllers/InstallController.js"></script>
  <script type="module" src="js/main.js"></script>
  
  <script type="module">
    import { APP_VERSION } from "./js/version.js";
    const m = document.querySelector('link[rel="manifest"]');
    if (m) {
      const u = new URL(m.getAttribute("href"), location.href);
      u.searchParams.set("v", APP_VERSION);
      m.setAttribute("href", u.pathname + "?" + u.searchParams.toString());
    }
  </script>

</body>

</html>